"use strict";(self.webpackChunkinstagram=self.webpackChunkinstagram||[]).push([[528],{2528:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var r=n(2791),s=n(6839),a=n(4165),c=n(5861),o=n(9439),l=n(6042),i=n(6307);var d=n(2303),u=n(184),m=function(e){var t=e.docId,n=e.totalLikes,s=e.likedPhoto,l=e.handleFocus,m=(0,r.useContext)(i.Z).user.uid,x=void 0===m?"":m,f=(0,r.useState)(s),p=(0,o.Z)(f,2),h=p[0],j=p[1],v=(0,r.useState)(n),g=(0,o.Z)(v,2),b=g[0],N=g[1],w=(0,r.useContext)(d.Z),y=w.firebase,k=w.FieldValue,I=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j((function(e){return!e})),e.next=3,y.firestore().collection("photos").doc(t).update({likes:h?k.arrayRemove(x):k.arrayUnion(x)});case 3:N((function(e){return h?e-1:e+1}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"flex justify-between p-4",children:(0,u.jsxs)("div",{className:"flex",children:[(0,u.jsx)("svg",{onClick:I,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,className:"w-10 mr-4 select-none cursor-pointer ".concat(h?"fill-red-500 text-red-500":"text-black"),children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(0,u.jsx)("svg",{onClick:l,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-10 text-black-light select-none cursor-pointer",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97a5.969 5.969 0 01-.474-.065 4.48 4.48 0 00.978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25z"})})]})}),(0,u.jsx)("div",{className:"p-4 py-0",children:(0,u.jsx)("p",{className:"font-bold",children:"".concat(b,1===b?" like":" likes")})})]})},x=n(3504),f=function(e){var t=e.username,n=e.avatarSrc;return(0,u.jsx)("div",{className:"flex border-b border-gray-primary h-4 p-4 py-8",children:(0,u.jsx)("div",{className:"flex items-center",children:(0,u.jsxs)(x.rU,{to:"/".concat(t),className:"flex items-center",children:[(0,u.jsx)("img",{className:"rounded-full border-sky-600 border-2 h-8 w-8 flex mr-3",src:n,alt:"".concat(t)}),(0,u.jsx)("p",{className:"font-bold",children:t})]})})})},p=function(e){var t=e.src,n=e.caption;return(0,u.jsx)("img",{className:"float-center",src:t,alt:n})},h=function(e){var t=e.caption,n=e.username;return(0,u.jsxs)("div",{className:"p-4 pt-2 pb-0",children:[(0,u.jsx)("span",{className:"mr-1 font-bold",children:n}),(0,u.jsx)("span",{children:t})]})},j=n(7346),v=n(3433),g=n(1528),b=(n(7010),function(e){var t=e.docId,n=e.comments,s=e.setComments,a=e.commentInput,c=(0,r.useState)(""),l=(0,o.Z)(c,2),m=l[0],x=l[1],f=(0,r.useRef)(),p=(0,r.useState)(!1),h=(0,o.Z)(p,2),j=h[0],b=h[1],N=(0,r.useContext)(d.Z),w=N.firebase,y=N.FieldValue,k=(0,r.useContext)(i.Z).user.displayName;(0,r.useEffect)((function(){function e(e){f.current&&!f.current.contains(e.target)&&b(!1)}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[f]);return(0,u.jsx)("div",{className:" h-12 border-t border-gray-primary",children:(0,u.jsxs)("form",{className:"flex justify-between pl-0 pr-5 relative",method:"POST",onSubmit:function(e){return m.length>=1?function(e){return e.preventDefault(),s([{displayName:k,comment:m}].concat((0,v.Z)(n))),x(""),w.firestore().collection("photos").doc(t).update({comments:y.arrayUnion({displayName:k,comment:m})})}(e):e.preventDefault()},children:[(0,u.jsxs)("div",{className:"flex items-center ml-3 cursor-pointer",onClick:function(){return b((function(e){return!e}))},children:[j&&(0,u.jsx)("div",{className:"absolute bg-white max-h-sm border rounded",style:{top:"-160px"},ref:f,children:(0,u.jsx)("div",{className:"grid max-h-40 overflow-auto grid-cols-12 p-1",children:g.W.map((function(e){return(0,u.jsx)("div",{className:"hover:bg-blue-500 p-1 cursor-pointer",onClick:function(){return x("".concat(m).concat(e))},children:(0,u.jsx)("span",{children:e})})}))})}),(0,u.jsx)("svg",{fill:"#000",height:"25px",role:"img",viewBox:"0 0 24 24",width:"15px",children:(0,u.jsx)("path",{d:"M15.83 10.997a1.167 1.167 0 101.167 1.167 1.167 1.167 0 00-1.167-1.167zm-6.5 1.167a1.167 1.167 0 10-1.166 1.167 1.167 1.167 0 001.166-1.167zm5.163 3.24a3.406 3.406 0 01-4.982.007 1 1 0 10-1.557 1.256 5.397 5.397 0 008.09 0 1 1 0 00-1.55-1.263zM12 .503a11.5 11.5 0 1011.5 11.5A11.513 11.513 0 0012 .503zm0 21a9.5 9.5 0 119.5-9.5 9.51 9.51 0 01-9.5 9.5z"})})]}),(0,u.jsx)("input",{"aria-label":"Add a comment",autoComplete:"off",className:"h-11 text-sm w-full mr-3 py-5 px-2",type:"text",name:"AddComment",placeholder:"Add a comment...",value:m,onChange:function(e){return x(e.target.value)},ref:a}),(0,u.jsx)("button",{type:"submit",className:"mt-2 border-2 w-20 rounded-xl text-sm font-bold text-blue-500",children:"Post"})]})})}),N=function(e){var t=e.docId,n=e.comments,s=e.posted,a=e.commentInput,c=(0,r.useState)(n),l=(0,o.Z)(c,2),i=l[0],d=l[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"p-4 pt-1 pb-4",children:[i.length>=3&&(0,u.jsxs)("p",{className:"text-sm text-gray-base mb-1 cursor-pointer",children:["View all ",i.length," comments"]}),i.slice(0,3).map((function(e){return(0,u.jsxs)("p",{className:"mb-1",children:[(0,u.jsx)(x.rU,{to:"/".concat(e.displayName),children:(0,u.jsx)("span",{className:"mr-1 font-bold",children:e.displayName})}),(0,u.jsx)("span",{children:e.comment})]},"".concat(e.comment,"-").concat(e.displayName))})),(0,u.jsxs)("p",{className:"text-gray-base uppercase text-xs mt-2",children:[(0,j.Z)(s,Date.now())," ago"]})]}),(0,u.jsx)(b,{docId:t,comments:i,setComments:d,commentInput:a})]})},w=function(e){var t=e.content,n=(0,r.useRef)(null);return(0,u.jsxs)("div",{className:"shadow-2xl rounded-xl col-span-4 border bg-white border-gray-primary mb-16",children:[(0,u.jsx)(f,{username:t.username,avatarSrc:t.avatarSrc}),(0,u.jsx)(p,{src:t.imageSrc,caption:t.caption}),(0,u.jsx)(m,{docId:t.docId,totalLikes:t.likes.length,likedPhoto:t.userLikedPhoto,handleFocus:function(){return n.current.focus()}}),(0,u.jsx)(h,{caption:t.caption,username:t.username}),(0,u.jsx)(N,{docId:t.docId,comments:t.comments,posted:t.dateCreated,commentInput:n})]})},y=function(){var e=function(){var e=(0,r.useState)(null),t=(0,o.Z)(e,2),n=t[0],s=t[1],d=(0,r.useContext)(i.Z).user.uid,u=void 0===d?"":d;return(0,r.useEffect)((function(){function e(){return e=(0,c.Z)((0,a.Z)().mark((function e(){var t,n,r,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.xD)(u);case 2:if(t=e.sent,n=(0,o.Z)(t,1),r=n[0],c=[],!(r.following.length>0)){e.next=10;break}return e.next=9,(0,l.wP)(u,r.following);case 9:c=e.sent;case 10:c.sort((function(e,t){return t.dateCreated-e.dateCreated})),s(c);case 12:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[u]),{photos:n}}(),t=e.photos;return(0,u.jsx)("div",{className:"container col-span-2",children:t?(null===t||void 0===t?void 0:t.length)>0?t.map((function(e){return(0,u.jsx)(w,{content:e},e.docId)})):(0,u.jsx)("p",{className:"text-center text-2xl",children:"No Followers!"}):(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(s.Z,{count:1,width:640,height:400,className:"mb-5"})})})},k=n(5628),I=function(e){var t=e.profileDocId,n=e.username,s=e.profileId,i=e.userId,d=e.loggedInUserDocId,m=e.profileImage,f=(0,r.useState)(!1),p=(0,o.Z)(f,2),h=p[0],j=p[1],v=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.next=3,(0,l.NS)(d,s,!1);case 3:return e.next=5,(0,l.T6)(t,i,!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return console.log(m),h?null:(0,u.jsxs)("div",{className:"flex flex-row items-center align-items justify-between",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsx)("div",{className:"w-8 h-8 rounded-full border-2 border-sky-600",children:(0,u.jsx)("img",{className:"p-[1.5px] border-red-500 rounded-full w-full h-full",src:m,alt:""})}),(0,u.jsx)(x.rU,{className:"ml-2",to:"/".concat(n),children:(0,u.jsx)("p",{className:"font-bold text-sm",children:n})})]}),(0,u.jsx)("div",{children:(0,u.jsx)("button",{className:"text-xs font-semibold py-1 px-4 rounded-full bg-blue-600 text-white",type:"button",onClick:v,children:"Follow"})})]})},Z=function(e){var t=e.userId,n=e.following,i=e.loggedInUserDocId,d=(0,r.useState)(null),m=(0,o.Z)(d,2),x=m[0],f=m[1];return(0,r.useEffect)((function(){function e(){return(e=(0,c.Z)((0,a.Z)().mark((function e(){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.ve)(t,n);case 2:r=e.sent,f(r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t&&function(){e.apply(this,arguments)}()}),[t]),x?x.length?(0,u.jsxs)("div",{className:"rounded flex flex-col",children:[(0,u.jsx)("div",{className:"flex items-center my-3 w-full",children:(0,u.jsx)("div",{className:"border-b-[1px] border-black h-0 w-full"})}),(0,u.jsx)("div",{className:"text-sm flex items-center align-items justify-between mb-2",children:(0,u.jsx)("p",{className:"font-bold text-gray-base"})}),(0,u.jsx)("div",{className:"mt-4 grid gap-5",children:x.map((function(e){return(0,u.jsx)(I,{profileImage:e.avatarSrc,profileDocId:e.docId,username:e.username,profileId:e.userId,userId:t,loggedInUserDocId:i},e.docId)}))})]}):null:(0,u.jsx)(s.Z,{count:1,height:150})},C=function(e){var t=e.username,n=e.fullName,r=e.avatarSrc;return t&&n?(0,u.jsxs)(x.rU,{to:"/".concat(t),className:"grid p-4 grid-cols-4 gap-4 mr-5 mb-6 items-center",children:[(0,u.jsx)("div",{className:"flex items-center justify-between p-1  rounded-full border-2 border-sky-600  col-span-1 w-20 h-20",children:(0,u.jsx)("img",{className:"rounded-full w-full h-full",src:r,alt:"",onError:function(e){e.target.src="/images/avatars/default/.jpg"}})}),(0,u.jsxs)("div",{className:"p-8 col-span-3",children:[(0,u.jsx)("p",{className:"font-bold text-sm",children:t}),(0,u.jsx)("p",{className:"text-sm",children:n})]})]}):(0,u.jsx)(s.Z,{count:1,height:61})},S=(0,r.memo)(C),L=function(){var e=(0,k.Z)().user,t=e.docId,n=e.fullName,r=e.username,s=e.userId,a=e.following,c=e.avatarSrc;return(0,u.jsxs)("div",{className:"p-4",children:[(0,u.jsx)(S,{username:r,fullName:n,avatarSrc:c}),(0,u.jsx)(Z,{userId:s,following:a,loggedInUserDocId:t})]})},z=function(){return(0,r.useEffect)((function(){document.title="My Instagram"}),[]),(0,u.jsx)("div",{className:"bg-gray-background mt-10 ",children:(0,u.jsxs)("div",{className:"grid grid-cols-3 gap-4 justify-between mx-auto max-w-screen-lg ",children:[(0,u.jsx)(y,{}),(0,u.jsx)(L,{})]})})}}}]);
//# sourceMappingURL=528.4d1e3328.chunk.js.map